#!/usr/bin/env bash
# #######################################################################
# author: Leo ning <windywany@gmail.com>
# date: 2022-08-06
# version: 1.0.0
#########################################################################
# 添加主机到以下数组里
HOSTS=(localhost)
#########################################################################
### do not edit this file unless you known what you are doing.###########
#########################################################################
if [[ ! -x $(command -v rsync) ]]; then
    echo "please install rsync first!"
    exit 1
fi

if [ $# -eq 0 ]; then
    echo "nothing to sync!"
    exit 1
fi

p1=$1
fname=$(basename $p1)

pdir=$(
    cd -P $(dirname $p1)
    pwd
)

usr=$(whoami)
lpath=$(realpath $pdir/$fname)

for host in ${HOSTS[@]}; do
    echo -e "sync \033[34m$lpath\033[0m to \033[36m$usr@${host}\033[0m:\033[34m${pdir}\033[0m\n"
    rsync -av "$lpath" ${usr}@${host}:"${pdir}"
done
### do not edit above codes #############################################
#########################################################################
